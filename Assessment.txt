#pip install pandas  ---------installed library


import sqlite3
import pandas as pd
 
connection = sqlite3.connection('C:/mydatabase/mydata.db')
 
sql_q = """
SELECT c.customer_id, c.age, i.item_id, SUM(o.quantity) AS total_quantity
FROM Customer c
JOIN Sales s ON c.customer_id = s.customer_id
JOIN Orders o ON s.sales_id = o.sales_id
JOIN Items i ON o.item_id = i.item_id
WHERE c.age BETWEEN 18 AND 35 AND o.quantity IS NOT NULL
GROUP BY c.customer_id, i.item_id
HAVING total_quantity > 0
"""
 
sql_results = connection.execute(sql_q).fetchall()
 
connection.close()
 
columns = ['Customer', 'Age', 'Item', 'Quantity']
df_sql = pd.DataFrame(sql_results, columns=columns)
 
df_sql.to_csv('output_sql.csv', sep=';', index=False)
 

df = pd.read_sql_q(sql_q, connection)
 
connection.close()
 
df.to_csv('output_pandas.csv', sep=';', index=False)